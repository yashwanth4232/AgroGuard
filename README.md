# üåø AgroGuard ‚Äì Crop Disease Detection using Deep Learning
AgroGuard is a machine learning-based crop disease detection system designed to help farmers and agriculturists identify diseases from leaf images and suggest suitable treatment methods. The system uses a Convolutional Neural Network (CNN) trained on the [PlantVillage dataset](https://www.kaggle.com/datasets/emmarex/plantdisease), and supports predictions from single or multiple leaf images.
---
## üóÇÔ∏è Project Structure
AgroGuard/
‚îÇ
‚îú‚îÄ‚îÄ PlantVillage/ # Dataset folder used for training (contains class-wise subfolders)
‚îÇ
‚îú‚îÄ‚îÄ test_leaf/ # Folder for uploading leaf images to test
‚îÇ ‚îî‚îÄ‚îÄ *.JPG # Add your leaf image(s) here
‚îÇ
‚îú‚îÄ‚îÄ crop_disease_model_improved.h5 # Trained CNN model (MobileNetV2-based)
‚îÇ
‚îú‚îÄ‚îÄ train.py # Script to train the model using PlantVillage dataset
‚îÇ
‚îú‚îÄ‚îÄ pred.py # Script to predict disease from uploaded leaf images
‚îÇ
‚îî‚îÄ‚îÄ .gitattributes # Git LFS config for versioning large .h5 files
---
## üöÄ How It Works

1. **Model Training (`train.py`)**
   - Uses TensorFlow and Keras.
   - Loads the `PlantVillage/` dataset.
   - Preprocesses and trains a CNN model (MobileNetV2).
   - Saves the model to `crop_disease_model_improved.h5`.

2. **Prediction (`pred.py`)**
   - Loads the trained `.h5` model.
   - Scans all images from the `test_leaf/` folder.
   - Preprocesses each image.
   - Predicts the disease class.
   - Displays the confidence and gives a treatment suggestion.
---
## üß† Supported Disease Classes
This project supports classification across the following plant-disease combinations:
- Apple: Black rot, Rust, Scab, Healthy
- Corn: Common Rust, Northern Leaf Blight, Gray Leaf Spot, Healthy
- Grape: Black rot, Esca (Black Measles), Leaf Blight, Healthy
- Potato: Early blight, Late blight, Healthy
- Tomato: Leaf Mold
---
## üõ†Ô∏è Requirements
Install the required libraries using:
```bash
pip install -r requirements.txt
If requirements.txt isn't available, install manually:
pip install tensorflow keras numpy pillow
---
## ‚öôÔ∏è How `train.py` Works (Model Training Script)

The `train.py` file is responsible for training the model using the PlantVillage dataset.

### üßæ Step-by-Step Process

1. **Load the Dataset**

   - The `PlantVillage/` folder must contain subfolders, each named after a plant-disease class.
   - Each subfolder contains sample images.

2. **Data Preprocessing**

   - Images are resized to 128x128 pixels.
   - The dataset is split into training and validation sets (typically 80/20 split).
   - Images are normalized (pixel values scaled between 0 and 1).

3. **Model Architecture**

   - Based on **MobileNetV2**, a lightweight CNN pre-trained on ImageNet.
   - The top layer is replaced with:
     - Global average pooling
     - Dense layer with `softmax` activation for classification

4. **Compilation**

   - Optimizer: `Adam`
   - Loss function: `categorical_crossentropy`
   - Metrics: `accuracy`

5. **Training**

   - The model is trained for multiple epochs (default is 30).
   - Accuracy and validation loss are tracked.

6. **Saving the Model**

   - The final model is saved as `crop_disease_model_improved.h5`.
in cmd : python train.py
‚ö†Ô∏è Note: Training may take time depending on the number of classes and system performance. It is recommended to use GPU for faster training.
üñºÔ∏è How to Use the Prediction Script (pred.py)
Place one or more leaf images inside the test_leaf/ folder.
Open terminal and navigate to the project directory.
Run the prediction script:
in cmd : python pred.py
The output will show the disease class, prediction confidence, and suggested treatment for each image found in test_leaf/.
üß† Supported Disease Classes
Apple: Black rot, Rust, Scab, Healthy
Corn: Common Rust, Northern Leaf Blight, Gray Leaf Spot, Healthy
Grape: Black rot, Esca (Black Measles), Leaf Blight, Healthy
Potato: Early blight, Late blight, Healthy
Tomato: Leaf Mold
üì¶ Requirements
Install the dependencies using:
pip install tensorflow keras numpy pillow
‚úÖ Example Prediction
üìå File: tomato_leaf.jpg
Disease: Tomato___Leaf_Mold
Confidence: 93.42%
Treatment: Ensure ventilation, reduce humidity, use fungicides like mancozeb.
ü§ù Contributions
Feel free to fork this repo, improve the model, or add new features. PRs are welcome!
üìß Contact
Made with ‚ù§Ô∏è by Yashwanth Kumar
üì¨ vunnamyashwanthkumar123@gmail.com      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
üåøüåøüåøüåøüåøüåøüåøüåøüåøüåø THANK YOU üåøüåøüåøüåøüåøüåøüåøüåøüåøüåøüåø
